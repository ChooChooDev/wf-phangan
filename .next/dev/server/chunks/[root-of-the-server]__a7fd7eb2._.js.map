{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/nwmac/ProjectC/shootingRange/project/lib/constants.ts"],"sourcesContent":["export const UUID_V5_NAMESPACE = '550e8400-e29b-41d4-a716-446655440000';\n\nexport const STOREHUB_TAG = 'wf-phangan';\n\nexport const MIN_AGE_YEARS = 20;\n\nexport const COUNTRIES = [\n  'Afghanistan', 'Albania', 'Algeria', 'Andorra', 'Angola', 'Antigua and Barbuda',\n  'Argentina', 'Armenia', 'Australia', 'Austria', 'Azerbaijan', 'Bahamas', 'Bahrain',\n  'Bangladesh', 'Barbados', 'Belarus', 'Belgium', 'Belize', 'Benin', 'Bhutan',\n  'Bolivia', 'Bosnia and Herzegovina', 'Botswana', 'Brazil', 'Brunei', 'Bulgaria',\n  'Burkina Faso', 'Burundi', 'Cabo Verde', 'Cambodia', 'Cameroon', 'Canada',\n  'Central African Republic', 'Chad', 'Chile', 'China', 'Colombia', 'Comoros',\n  'Congo', 'Costa Rica', 'Croatia', 'Cuba', 'Cyprus', 'Czech Republic',\n  'Democratic Republic of the Congo', 'Denmark', 'Djibouti', 'Dominica',\n  'Dominican Republic', 'East Timor', 'Ecuador', 'Egypt', 'El Salvador',\n  'Equatorial Guinea', 'Eritrea', 'Estonia', 'Eswatini', 'Ethiopia', 'Fiji',\n  'Finland', 'France', 'Gabon', 'Gambia', 'Georgia', 'Germany', 'Ghana', 'Greece',\n  'Grenada', 'Guatemala', 'Guinea', 'Guinea-Bissau', 'Guyana', 'Haiti', 'Honduras',\n  'Hungary', 'Iceland', 'India', 'Indonesia', 'Iran', 'Iraq', 'Ireland', 'Israel',\n  'Italy', 'Ivory Coast', 'Jamaica', 'Japan', 'Jordan', 'Kazakhstan', 'Kenya',\n  'Kiribati', 'Kosovo', 'Kuwait', 'Kyrgyzstan', 'Laos', 'Latvia', 'Lebanon',\n  'Lesotho', 'Liberia', 'Libya', 'Liechtenstein', 'Lithuania', 'Luxembourg',\n  'Madagascar', 'Malawi', 'Malaysia', 'Maldives', 'Mali', 'Malta', 'Marshall Islands',\n  'Mauritania', 'Mauritius', 'Mexico', 'Micronesia', 'Moldova', 'Monaco', 'Mongolia',\n  'Montenegro', 'Morocco', 'Mozambique', 'Myanmar', 'Namibia', 'Nauru', 'Nepal',\n  'Netherlands', 'New Zealand', 'Nicaragua', 'Niger', 'Nigeria', 'North Korea',\n  'North Macedonia', 'Norway', 'Oman', 'Pakistan', 'Palau', 'Palestine', 'Panama',\n  'Papua New Guinea', 'Paraguay', 'Peru', 'Philippines', 'Poland', 'Portugal',\n  'Qatar', 'Romania', 'Russia', 'Rwanda', 'Saint Kitts and Nevis', 'Saint Lucia',\n  'Saint Vincent and the Grenadines', 'Samoa', 'San Marino', 'Sao Tome and Principe',\n  'Saudi Arabia', 'Senegal', 'Serbia', 'Seychelles', 'Sierra Leone', 'Singapore',\n  'Slovakia', 'Slovenia', 'Solomon Islands', 'Somalia', 'South Africa', 'South Korea',\n  'South Sudan', 'Spain', 'Sri Lanka', 'Sudan', 'Suriname', 'Sweden', 'Switzerland',\n  'Syria', 'Taiwan', 'Tajikistan', 'Tanzania', 'Thailand', 'Togo', 'Tonga',\n  'Trinidad and Tobago', 'Tunisia', 'Turkey', 'Turkmenistan', 'Tuvalu', 'Uganda',\n  'Ukraine', 'United Arab Emirates', 'United Kingdom', 'United States', 'Uruguay',\n  'Uzbekistan', 'Vanuatu', 'Vatican City', 'Venezuela', 'Vietnam', 'Yemen', 'Zambia',\n  'Zimbabwe'\n];\n"],"names":[],"mappings":";;;;;;;;;;AAAO,MAAM,oBAAoB;AAE1B,MAAM,eAAe;AAErB,MAAM,gBAAgB;AAEtB,MAAM,YAAY;IACvB;IAAe;IAAW;IAAW;IAAW;IAAU;IAC1D;IAAa;IAAW;IAAa;IAAW;IAAc;IAAW;IACzE;IAAc;IAAY;IAAW;IAAW;IAAU;IAAS;IACnE;IAAW;IAA0B;IAAY;IAAU;IAAU;IACrE;IAAgB;IAAW;IAAc;IAAY;IAAY;IACjE;IAA4B;IAAQ;IAAS;IAAS;IAAY;IAClE;IAAS;IAAc;IAAW;IAAQ;IAAU;IACpD;IAAoC;IAAW;IAAY;IAC3D;IAAsB;IAAc;IAAW;IAAS;IACxD;IAAqB;IAAW;IAAW;IAAY;IAAY;IACnE;IAAW;IAAU;IAAS;IAAU;IAAW;IAAW;IAAS;IACvE;IAAW;IAAa;IAAU;IAAiB;IAAU;IAAS;IACtE;IAAW;IAAW;IAAS;IAAa;IAAQ;IAAQ;IAAW;IACvE;IAAS;IAAe;IAAW;IAAS;IAAU;IAAc;IACpE;IAAY;IAAU;IAAU;IAAc;IAAQ;IAAU;IAChE;IAAW;IAAW;IAAS;IAAiB;IAAa;IAC7D;IAAc;IAAU;IAAY;IAAY;IAAQ;IAAS;IACjE;IAAc;IAAa;IAAU;IAAc;IAAW;IAAU;IACxE;IAAc;IAAW;IAAc;IAAW;IAAW;IAAS;IACtE;IAAe;IAAe;IAAa;IAAS;IAAW;IAC/D;IAAmB;IAAU;IAAQ;IAAY;IAAS;IAAa;IACvE;IAAoB;IAAY;IAAQ;IAAe;IAAU;IACjE;IAAS;IAAW;IAAU;IAAU;IAAyB;IACjE;IAAoC;IAAS;IAAc;IAC3D;IAAgB;IAAW;IAAU;IAAc;IAAgB;IACnE;IAAY;IAAY;IAAmB;IAAW;IAAgB;IACtE;IAAe;IAAS;IAAa;IAAS;IAAY;IAAU;IACpE;IAAS;IAAU;IAAc;IAAY;IAAY;IAAQ;IACjE;IAAuB;IAAW;IAAU;IAAgB;IAAU;IACtE;IAAW;IAAwB;IAAkB;IAAiB;IACtE;IAAc;IAAW;IAAgB;IAAa;IAAW;IAAS;IAC1E;CACD"}},
    {"offset": {"line": 262, "column": 0}, "map": {"version":3,"sources":["file:///Users/nwmac/ProjectC/shootingRange/project/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr';\nimport { cookies } from 'next/headers';\nimport type { Database } from '@/types/database';\n\nexport async function createClient() {\n  const cookieStore = await cookies();\n\n  return createServerClient<Database>(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll();\n        },\n        setAll(cookiesToSet) {\n          try {\n            cookiesToSet.forEach(({ name, value, options }) =>\n              cookieStore.set(name, value, options)\n            );\n          } catch {\n          }\n        },\n      },\n    }\n  );\n}\n\nexport async function createServiceClient() {\n  const cookieStore = await cookies();\n\n  return createServerClient<Database>(\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\n    process.env.SUPABASE_SERVICE_ROLE_KEY!,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll();\n        },\n        setAll(cookiesToSet) {\n          try {\n            cookiesToSet.forEach(({ name, value, options }) =>\n              cookieStore.set(name, value, options)\n            );\n          } catch {\n          }\n        },\n      },\n    }\n  );\n}\n"],"names":[],"mappings":";;;;;;AAAA;AAAA;AACA;;;AAGO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,OAAO,IAAA,iMAAkB,sUAGvB;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM,CACR;YACF;QACF;IACF;AAEJ;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,OAAO,IAAA,iMAAkB,gFAEvB,QAAQ,GAAG,CAAC,yBAAyB,EACrC;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM,CACR;YACF;QACF;IACF;AAEJ"}},
    {"offset": {"line": 307, "column": 0}, "map": {"version":3,"sources":["file:///Users/nwmac/ProjectC/shootingRange/project/app/api/storehub/create/route.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\nimport { STOREHUB_TAG } from \"@/lib/constants\";\nimport { createServiceClient } from \"@/lib/supabase/server\";\nimport { NextRequest, NextResponse } from \"next/server\";\n\nexport async function POST(request: NextRequest) {\n  const startTime = Date.now();\n\n  try {\n    const { submissionId } = await request.json();\n\n    if (!submissionId) {\n      return NextResponse.json(\n        { success: false, error: \"Missing submissionId\" },\n        { status: 400 }\n      );\n    }\n\n    const supabase = await createServiceClient();\n\n    const { data: submission, error: fetchError } = await supabase\n      .from(\"member_submissions\")\n      .select(\"*\")\n      .eq(\"id\", submissionId)\n      .maybeSingle();\n\n    if (fetchError || !submission) {\n      return NextResponse.json(\n        { success: false, error: \"Submission not found\" },\n        { status: 404 }\n      );\n    }\n\n    const record = submission as any;\n\n    await (supabase.from(\"member_submissions\") as any)\n      .update({ status: \"processing\" })\n      .eq(\"id\", submissionId);\n\n    const storeHubPayload = {\n      refId: record.ref_id,\n      firstName: record.first_name,\n      lastName: record.last_name,\n      address1: record.passport_number,\n      state: record.nationality,\n      birthday: record.date_of_birth,\n      tags: [STOREHUB_TAG],\n    };\n\n    // Create Basic Auth header using username:password from .env.local\n    const authHeader = Buffer.from(\n      `${process.env.STOREHUB_USERNAME}:${process.env.STOREHUB_PASSWORD}`\n    ).toString(\"base64\");\n\n    // Send POST request to StoreHub API\n    const storeHubResponse = await fetch(\n      \"https://api.storehubhq.com/customers\",\n      {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Basic ${authHeader}`,\n        },\n        body: JSON.stringify(storeHubPayload),\n      }\n    );\n\n    const duration = Date.now() - startTime;\n    const responseText = await storeHubResponse.text();\n    let responseBody;\n\n    try {\n      responseBody = JSON.parse(responseText);\n    } catch {\n      responseBody = { raw: responseText };\n    }\n\n    const success = storeHubResponse.ok;\n\n    await supabase.from(\"api_logs\").insert({\n      member_submission_id: submissionId,\n      ref_id: record.ref_id,\n      request_type: \"create\",\n      request_body: storeHubPayload,\n      request_headers: { \"Content-Type\": \"application/json\" },\n      response_status: storeHubResponse.status,\n      response_body: responseBody,\n      success,\n      error_message: success ? null : responseText,\n      duration_ms: duration,\n      created_by: record.created_by,\n    } as any);\n\n    if (success) {\n      await (supabase.from(\"member_submissions\") as any)\n        .update({\n          status: \"success\",\n          storehub_synced_at: new Date().toISOString(),\n          storehub_error: null,\n        })\n        .eq(\"id\", submissionId);\n\n      return NextResponse.json({ success: true, data: responseBody });\n    } else {\n      await (supabase.from(\"member_submissions\") as any)\n        .update({\n          status: \"storehub_failed\",\n          storehub_error: responseText,\n        })\n        .eq(\"id\", submissionId);\n\n      return NextResponse.json({\n        success: false,\n        error: `StoreHub API error: ${storeHubResponse.status}`,\n      });\n    }\n  } catch (error: any) {\n    console.error(\"StoreHub API error:\", error);\n    return NextResponse.json(\n      {\n        success: false,\n        error: error.message || \"Internal server error\",\n      },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":"AAAA,qDAAqD;;;;AACrD;AACA;AACA;;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,MAAM,YAAY,KAAK,GAAG;IAE1B,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE3C,IAAI,CAAC,cAAc;YACjB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAuB,GAChD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,WAAW,MAAM,IAAA,kJAAmB;QAE1C,MAAM,EAAE,MAAM,UAAU,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM,SACnD,IAAI,CAAC,sBACL,MAAM,CAAC,KACP,EAAE,CAAC,MAAM,cACT,WAAW;QAEd,IAAI,cAAc,CAAC,YAAY;YAC7B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAuB,GAChD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,SAAS;QAEf,MAAM,AAAC,SAAS,IAAI,CAAC,sBAClB,MAAM,CAAC;YAAE,QAAQ;QAAa,GAC9B,EAAE,CAAC,MAAM;QAEZ,MAAM,kBAAkB;YACtB,OAAO,OAAO,MAAM;YACpB,WAAW,OAAO,UAAU;YAC5B,UAAU,OAAO,SAAS;YAC1B,UAAU,OAAO,eAAe;YAChC,OAAO,OAAO,WAAW;YACzB,UAAU,OAAO,aAAa;YAC9B,MAAM;gBAAC,kIAAY;aAAC;QACtB;QAEA,mEAAmE;QACnE,MAAM,aAAa,OAAO,IAAI,CAC5B,GAAG,QAAQ,GAAG,CAAC,iBAAiB,CAAC,CAAC,EAAE,QAAQ,GAAG,CAAC,iBAAiB,EAAE,EACnE,QAAQ,CAAC;QAEX,oCAAoC;QACpC,MAAM,mBAAmB,MAAM,MAC7B,wCACA;YACE,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,eAAe,CAAC,MAAM,EAAE,YAAY;YACtC;YACA,MAAM,KAAK,SAAS,CAAC;QACvB;QAGF,MAAM,WAAW,KAAK,GAAG,KAAK;QAC9B,MAAM,eAAe,MAAM,iBAAiB,IAAI;QAChD,IAAI;QAEJ,IAAI;YACF,eAAe,KAAK,KAAK,CAAC;QAC5B,EAAE,OAAM;YACN,eAAe;gBAAE,KAAK;YAAa;QACrC;QAEA,MAAM,UAAU,iBAAiB,EAAE;QAEnC,MAAM,SAAS,IAAI,CAAC,YAAY,MAAM,CAAC;YACrC,sBAAsB;YACtB,QAAQ,OAAO,MAAM;YACrB,cAAc;YACd,cAAc;YACd,iBAAiB;gBAAE,gBAAgB;YAAmB;YACtD,iBAAiB,iBAAiB,MAAM;YACxC,eAAe;YACf;YACA,eAAe,UAAU,OAAO;YAChC,aAAa;YACb,YAAY,OAAO,UAAU;QAC/B;QAEA,IAAI,SAAS;YACX,MAAM,AAAC,SAAS,IAAI,CAAC,sBAClB,MAAM,CAAC;gBACN,QAAQ;gBACR,oBAAoB,IAAI,OAAO,WAAW;gBAC1C,gBAAgB;YAClB,GACC,EAAE,CAAC,MAAM;YAEZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAM,MAAM;YAAa;QAC/D,OAAO;YACL,MAAM,AAAC,SAAS,IAAI,CAAC,sBAClB,MAAM,CAAC;gBACN,QAAQ;gBACR,gBAAgB;YAClB,GACC,EAAE,CAAC,MAAM;YAEZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,OAAO,CAAC,oBAAoB,EAAE,iBAAiB,MAAM,EAAE;YACzD;QACF;IACF,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,OAAO,MAAM,OAAO,IAAI;QAC1B,GACA;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}