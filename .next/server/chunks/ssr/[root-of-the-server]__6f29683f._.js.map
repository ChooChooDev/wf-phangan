{"version":3,"sources":["../../../../app/logs/page.tsx"],"sourcesContent":["import LanguageSwitcher from \"@/components/LanguageSwitcher\";\nimport { createClient } from \"@/lib/supabase/server\";\nimport { cookies } from \"next/headers\";\nimport Link from \"next/link\";\nimport { redirect } from \"next/navigation\";\n\nasync function getLogs() {\n  const supabase = await createClient();\n\n  const { data: logs, error } = await (supabase\n    .from(\"api_logs\")\n    .select(\n      `\n      *,\n      member_submissions (\n        full_name\n      )\n    `\n    )\n    .order(\"created_at\", { ascending: false })\n    .limit(50) as any);\n\n  if (error) {\n    console.error(\"Error fetching logs:\", error);\n    return [];\n  }\n\n  return (logs || []) as any[];\n}\n\nexport default async function LogsPage() {\n  const supabase = await createClient();\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    redirect(\"/login\");\n  }\n\n  const logs = await getLogs();\n  const cookieStore = await cookies();\n  const currentLocale = cookieStore.get(\"NEXT_LOCALE\")?.value || \"en\";\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <header className=\"bg-white shadow-sm\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">\n          <div className=\"flex justify-between items-center\">\n            <h1 className=\"text-2xl font-bold text-gray-900\">\n              {currentLocale === \"th\" ? \"บันทึก API\" : \"API Logs\"}\n            </h1>\n            <div className=\"flex items-center gap-4\">\n              <LanguageSwitcher currentLocale={currentLocale} />\n              <Link\n                href=\"/dashboard\"\n                className=\"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition\"\n              >\n                {currentLocale === \"th\" ? \"กลับหน้าหลัก\" : \"Back to Dashboard\"}\n              </Link>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n          {logs.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <p className=\"text-gray-600\">\n                {currentLocale === \"th\" ? \"ไม่พบบันทึก\" : \"No logs found\"}\n              </p>\n            </div>\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <table className=\"min-w-full divide-y divide-gray-200\">\n                <thead className=\"bg-gray-50\">\n                  <tr>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                      {currentLocale === \"th\" ? \"เวลา\" : \"Time\"}\n                    </th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                      {currentLocale === \"th\" ? \"ชื่อ\" : \"Name\"}\n                    </th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                      {currentLocale === \"th\" ? \"รหัสอ้างอิง\" : \"Ref ID\"}\n                    </th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                      {currentLocale === \"th\" ? \"ประเภท\" : \"Type\"}\n                    </th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                      {currentLocale === \"th\" ? \"สถานะ\" : \"Status\"}\n                    </th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                      {currentLocale === \"th\" ? \"รหัสตอบกลับ\" : \"Response\"}\n                    </th>\n                    <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                      {currentLocale === \"th\" ? \"ระยะเวลา\" : \"Duration\"}\n                    </th>\n                  </tr>\n                </thead>\n                <tbody className=\"bg-white divide-y divide-gray-200\">\n                  {logs.map((log) => (\n                    <tr key={log.id} className=\"hover:bg-gray-50\">\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                        {new Date(log.created_at).toLocaleString(\n                          currentLocale === \"th\" ? \"th-TH\" : \"en-US\"\n                        )}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                        {log.member_submissions?.full_name || \"N/A\"}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm font-mono text-gray-600\">\n                        {log.ref_id}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                        <span\n                          className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\n                            log.request_type === \"create\"\n                              ? \"bg-blue-100 text-blue-800\"\n                              : \"bg-purple-100 text-purple-800\"\n                          }`}\n                        >\n                          {log.request_type === \"create\"\n                            ? currentLocale === \"th\"\n                              ? \"สร้าง\"\n                              : \"Create\"\n                            : currentLocale === \"th\"\n                            ? \"ลองใหม่\"\n                            : \"Retry\"}\n                        </span>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm\">\n                        <span\n                          className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${\n                            log.success\n                              ? \"bg-green-100 text-green-800\"\n                              : \"bg-red-100 text-red-800\"\n                          }`}\n                        >\n                          {log.success\n                            ? currentLocale === \"th\"\n                              ? \"สำเร็จ\"\n                              : \"Success\"\n                            : currentLocale === \"th\"\n                            ? \"ล้มเหลว\"\n                            : \"Failed\"}\n                        </span>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                        {log.response_status || \"N/A\"}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-600\">\n                        {log.duration_ms ? `${log.duration_ms}ms` : \"N/A\"}\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          )}\n        </div>\n\n        {logs.length > 0 && (\n          <div className=\"mt-4 text-sm text-gray-600 text-center\">\n            {currentLocale === \"th\"\n              ? `แสดง ${logs.length} รายการล่าสุด`\n              : `Showing last ${logs.length} entries`}\n          </div>\n        )}\n      </main>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}