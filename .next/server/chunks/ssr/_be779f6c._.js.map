{"version":3,"sources":["../../../../node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","../../../../app/dashboard/page.tsx","../../../../.next-internal/server/app/dashboard/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","import LanguageSwitcher from \"@/components/LanguageSwitcher\";\nimport { createClient } from \"@/lib/supabase/server\";\nimport { cookies } from \"next/headers\";\nimport Link from \"next/link\";\nimport { redirect } from \"next/navigation\";\n\nasync function getStats() {\n  const supabase = await createClient();\n\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n\n  const [totalResult, todayResult, failedResult] = await Promise.all([\n    supabase\n      .from(\"member_submissions\")\n      .select(\"count\", { count: \"exact\", head: true }),\n    supabase\n      .from(\"member_submissions\")\n      .select(\"count\", { count: \"exact\", head: true })\n      .gte(\"created_at\", today.toISOString()),\n    supabase\n      .from(\"member_submissions\")\n      .select(\"count\", { count: \"exact\", head: true })\n      .eq(\"status\", \"storehub_failed\"),\n  ]);\n\n  return {\n    total: totalResult.count || 0,\n    today: todayResult.count || 0,\n    failed: failedResult.count || 0,\n  };\n}\n\nexport default async function DashboardPage() {\n  const supabase = await createClient();\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    redirect(\"/login\");\n  }\n\n  const stats = await getStats();\n  const cookieStore = await cookies();\n  const currentLocale = cookieStore.get(\"NEXT_LOCALE\")?.value || \"en\";\n\n  async function handleLogout() {\n    \"use server\";\n    const supabase = await createClient();\n    await supabase.auth.signOut();\n    redirect(\"/login\");\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <header className=\"bg-white shadow-sm\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">\n          <div className=\"flex justify-between items-center\">\n            <h1 className=\"text-2xl font-bold text-gray-900\">\n              {currentLocale === \"th\"\n                ? \"ลงทะเบียนสมาชิก\"\n                : \"Member Registration\"}\n            </h1>\n            <div className=\"flex items-center gap-4\">\n              <LanguageSwitcher currentLocale={currentLocale} />\n              <form action={handleLogout}>\n                <button\n                  type=\"submit\"\n                  className=\"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition\"\n                >\n                  {currentLocale === \"th\" ? \"ออกจากระบบ\" : \"Logout\"}\n                </button>\n              </form>\n            </div>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8\">\n        <div className=\"mb-8\">\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-1\">\n            {currentLocale === \"th\" ? \"ยินดีต้อนรับ\" : \"Welcome\"}, {user.email}\n          </h2>\n          <p className=\"text-gray-600\">\n            {currentLocale === \"th\"\n              ? \"เลือกการดำเนินการด้านล่าง\"\n              : \"Select an action below\"}\n          </p>\n        </div>\n\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\n          <div className=\"bg-white rounded-lg shadow p-6\">\n            <div className=\"text-sm font-medium text-gray-600 mb-1\">\n              {currentLocale === \"th\" ? \"สมาชิกทั้งหมด\" : \"Total Members\"}\n            </div>\n            <div className=\"text-3xl font-bold text-gray-900\">\n              {stats.total}\n            </div>\n          </div>\n\n          <div className=\"bg-white rounded-lg shadow p-6\">\n            <div className=\"text-sm font-medium text-gray-600 mb-1\">\n              {currentLocale === \"th\"\n                ? \"ลงทะเบียนวันนี้\"\n                : \"Today's Registrations\"}\n            </div>\n            <div className=\"text-3xl font-bold text-blue-600\">\n              {stats.today}\n            </div>\n          </div>\n\n          <div className=\"bg-white rounded-lg shadow p-6\">\n            <div className=\"text-sm font-medium text-gray-600 mb-1\">\n              {currentLocale === \"th\"\n                ? \"การส่งที่ล้มเหลว\"\n                : \"Failed Submissions\"}\n            </div>\n            <div className=\"text-3xl font-bold text-red-600\">\n              {stats.failed}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"flex flex-col gap-6\">\n          <Link href=\"/register\">\n            <div className=\"bg-blue-600 hover:bg-blue-700 transition rounded-lg shadow-lg p-8 text-white cursor-pointer\">\n              <div className=\"text-2xl font-bold mb-2\">\n                {currentLocale === \"th\" ? \"ลงทะเบียนใหม่\" : \"New Registration\"}\n              </div>\n              <div className=\"text-blue-100\">\n                {currentLocale === \"th\"\n                  ? \"ลงทะเบียนสมาชิกใหม่\"\n                  : \"Register a new member\"}\n              </div>\n            </div>\n          </Link>\n          <div className=\"flex flex-row gap-6 w-full justify-between\">\n            <Link href=\"/failed\">\n              <div className=\"bg-red-600 hover:bg-red-700 transition rounded-lg shadow-lg p-8 text-white cursor-pointer w-full \">\n                <div className=\"text-2xl font-bold mb-2\">\n                  {currentLocale === \"th\"\n                    ? \"จัดการการส่งที่ล้มเหลว\"\n                    : \"Manage Failed\"}\n                </div>\n                <div className=\"text-red-100\">\n                  {currentLocale === \"th\"\n                    ? \"ลองใหม่หรือยกเลิกการส่งที่ล้มเหลว\"\n                    : \"Retry or cancel failed submissions\"}\n                </div>\n              </div>\n            </Link>\n\n            <Link href=\"/logs\">\n              <div className=\"bg-white hover:bg-gray-50 transition rounded-lg shadow-lg p-8 border-2 border-gray-200 cursor-pointer w-full\">\n                <div className=\"text-2xl font-bold text-gray-900 mb-2\">\n                  {currentLocale === \"th\" ? \"ดูบันทึก\" : \"View Logs\"}\n                </div>\n                <div className=\"text-gray-600\">\n                  {currentLocale === \"th\"\n                    ? \"ดูบันทึกการเรียก API\"\n                    : \"View API call logs\"}\n                </div>\n              </div>\n            </Link>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}\n","export {$$RSC_SERVER_ACTION_0 as '00e0266d951844f4571ea812579811c50eed35f418'} from 'ACTIONS_MODULE0'\n"],"names":["registerServerReference"],"mappings":"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","ignoreList":[0]}